<ion-header>
</ion-header>

<ion-content class="ion-padding">
  <ion-grid>
    <ion-row class="ion-align-items-center">
      <ion-col size="auto">
        <ion-icon id="ghlogin-logo-github" name="logo-github"></ion-icon>
      </ion-col>
      <ion-col>
        <ion-text color="dark"><h2>Login to GitHub</h2></ion-text>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col>
        <ion-text color="success">
          <h5 *ngIf="existingLogin">
            Currently logged in and saving to {{ configuredRepo }}
          </h5>
        </ion-text>
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-list lines="full">
    <form [formGroup]="ghloginForm">
      <ion-item>
        <ion-label>Private Repository</ion-label>
        <ion-input
          formControlName="ghpr" 
          inputmode="text" 
          clearInput
          placeholder="username/repository"
          [class.invalid]="!ghloginForm.controls.ghpr.valid && (ghloginForm.controls.ghpr.dirty || submitAttempt)"
        ></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Personal Access Token <ion-icon name="arrow-down-outline"></ion-icon></ion-label>
        <ion-textarea
          formControlName="ghpat" 
          inputmode="text"
          placeholder="GitHub Personal Access Token"
          [class.invalid]="!ghloginForm.controls.ghpat.valid && (ghloginForm.controls.ghpat.dirty || submitAttempt)"
        ></ion-textarea>
      </ion-item>
    </form>
  </ion-list>
  <ion-text color={{statusColor}}><b><p id="progress-status">{{statusText}}</p></b></ion-text>
  <ion-progress-bar value="{{statusValue}}" buffer="{{statusBuffer}}" color="primary"></ion-progress-bar>
  <br>
  <ion-button expand="block" size="default" (click)="save()" [disabled]="buttonDisabled">Check</ion-button>
  <ion-text color="dark">
    <h2>
      Persistent Data Storage with GitHub
    </h2>
    <hr>
  </ion-text>
  <ion-text color="dark">
    <p>
      studyit uses GitHub private repositories as a database for all of your calendar event data, making your raw data both easy to see and control.
      <br><br>
      In order to make this work however, studyit needs a Personal Access Token which has read and write permissions to a private repository. This will let studyit read saved events as well as write new events to be saved.
      <br><br>
      Below, please enter the name of the private repository that studyit should save its data to, as well as the Personal Access Token (PAT) that studyit can use to access the private repository.
      <br><br>
      The Personal Access Token will be saved locally on this device where only studyit can reach. We use <a href="https://github.com/TheCocoaProject/cordova-plugin-nativestorage">this Cordova plugin</a> to save your PAT and private repository URL.
      <br><br>
      For more information on Private Repositories, check out <a href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/managing-repository-settings/setting-repository-visibility">this page</a> on the GitHub docs. And for more information on Personal Access Tokens, check out <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token">this page</a> also on the GitHub docs.
    </p>
  </ion-text>
</ion-content>
